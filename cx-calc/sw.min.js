// @ts-nocheck
const CACHE_NAME="cx-calc-1.0.4",OFFLINE_PAGE=new URL("index.html",self.location).href,ASSETS=[OFFLINE_PAGE,"style.css","main.js","calc.js","history.js","status.js","fontcalc.js","Calculator0.png","CalcFav.png","Calc144.png","K123.png","K456.png","K789.png","M123.png","BS.png","C.png","Switch.png","Settings.png","Paste.png","Plus.png","Help.png","Eq.png","manifest.webmanifest"].map((e=>new URL(e,self.location).href));self.addEventListener("install",(e=>{e.waitUntil(caches.open(CACHE_NAME).then((e=>(console.log("SW: Опит за кеширане на статични ресурси..."),e.addAll(ASSETS)))).then((()=>self.skipWaiting())).catch((e=>{console.error("SW: Неуспешно кеширане на ресурси по време на инсталация:",e)})))})),self.addEventListener("activate",(e=>{e.waitUntil(caches.keys().then((e=>Promise.all(e.filter((e=>e!==CACHE_NAME)).map((e=>caches.delete(e)))))).then((()=>self.clients.claim()))),self.clients.matchAll().then((e=>{e.forEach((e=>{e.postMessage({type:"NEW_VERSION_AVAILABLE"})}))}))})),self.addEventListener("fetch",(e=>{const{request:t}=e;new URL(t.url).origin===location.origin&&("navigate"!==t.mode?"image"!==t.destination?["style","script"].includes(t.destination)?e.respondWith(caches.match(t).then((e=>e||fetch(t).then((e=>{if(e.ok){const n=e.clone();caches.open(CACHE_NAME).then((e=>e.put(t,n)))}return e}))))):e.respondWith(fetch(t).then((e=>{if(e.ok&&"GET"===t.method){const n=e.clone();caches.open(CACHE_NAME).then((e=>e.put(t,n)))}return e})).catch((()=>caches.match(t).then((e=>e||caches.match(OFFLINE_PAGE)))))):e.respondWith(caches.match(t).then((e=>e||fetch(t).then((e=>{if(e.ok){const n=e.clone();caches.open(CACHE_NAME).then((e=>e.put(t,n)))}return e}))))):e.respondWith(fetch(t).then((e=>{const n=e.clone(),c=new URL(t.url);return c.search="",c.hash="",caches.open(CACHE_NAME).then((e=>e.put(c.href,n))),e})).catch((()=>{const e=new URL(t.url);return e.search="",e.hash="",caches.match(e.href)}))))}));