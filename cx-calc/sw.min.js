// @ts-nocheck
const CACHE_NAME="cx-calc-1.0.4",OFFLINE_PAGE="./cx-calc/index.html",ASSETS=[OFFLINE_PAGE,"style.css","main.js","calc.js","history.js","status.js","fontcalc.js","click.wav","Calculator0.png","CalculatorA.png","CalcFav.png","Calc32.png","Calc48.png","Calc120.png","Calc144.png","Calc192.png","Calc512.png","K123.png","K456.png","K789.png","M123.png","BS.png","C.png","Switch.png","Settings.png","Paste.png","Plus.png","Help.png","Eq.png","manifest.webmanifest"].map((e=>new URL(e,self.location).href));self.addEventListener("install",(e=>{e.waitUntil(caches.open(CACHE_NAME).then((e=>(console.log("SW: Опит за кеширане на статични ресурси..."),e.addAll(ASSETS)))).then((()=>self.skipWaiting())).catch((e=>{console.error("SW: Неуспешно кеширане на ресурси по време на инсталация:",e)})))})),self.addEventListener("activate",(e=>{e.waitUntil(caches.keys().then((e=>Promise.all(e.filter((e=>e!==CACHE_NAME)).map((e=>caches.delete(e)))))).then((()=>self.clients.claim()))),self.clients.matchAll().then((e=>{e.forEach((e=>{e.postMessage({type:"NEW_VERSION_AVAILABLE"})}))}))})),self.addEventListener("fetch",(e=>{const{request:n}=e;new URL(n.url).origin===location.origin&&("navigate"!==n.mode?"image"!==n.destination?["style","script"].includes(n.destination)?e.respondWith(caches.match(n).then((e=>e||fetch(n).then((e=>{if(e.ok){const t=e.clone();caches.open(CACHE_NAME).then((e=>e.put(n,t)))}return e}))))):e.respondWith(fetch(n).then((e=>{if(e.ok&&"GET"===n.method){const t=e.clone();caches.open(CACHE_NAME).then((e=>e.put(n,t)))}return e})).catch((()=>caches.match(n).then((e=>e||caches.match(OFFLINE_PAGE)))))):e.respondWith(caches.match(n).then((e=>e||fetch(n).then((e=>{if(e.ok){const t=e.clone();caches.open(CACHE_NAME).then((e=>e.put(n,t)))}return e}))))):e.respondWith(fetch(n).then((e=>{const t=e.clone(),c=new URL(n.url);return c.search="",c.hash="",caches.open(CACHE_NAME).then((e=>e.put(c.href,t))),e})).catch((()=>{const e=new URL(n.url);return e.search="",e.hash="",caches.match(e.href)}))))}));